## RFID-модуль

> В данный момент модуль находится в начале разработки

Модуль состоит из двух частей, написанных на языках C++ и Python. Модуль предоставляет возможность работы с RFID-оборудованием (ридером) через код, написанный на языке Python.

Доступ к функциям модуля осуществляется посредством HTTP-запросов по определённому API.


#### Предоставляемые функции

- соединение с ридером
- инвентаризация (получения серийных номеров меток)
- чтение информации с меток
- запись информации в метки


#### Зависимости проекта

- оборудование, для которого создавалось ПО:

    - антенна ID ISC.ANT300/300-A
    - ридер ID ISC.MR200 A
    - какие-то метки по 1792 байт (1,75 килобайт)

- для сборки С++-модуля:

    - Microsoft Visual Studio 2012
    - FEIG SDK (ID ISC.SDK.Win V4.7.0)

- для Python-модуля:

    - Python 3.6.0 32 bit
    - flask == 0.12

- дополнительные требования:

    - Windows 7 и выше
    - наличие COM-порта для подключения ридера


#### Устройство репозитория

> Файлы из FEIG SDK не добавлены в репозиторий, их нужно будет самостоятельно скопировать в нужные директории

- `/lib` — FEIG SDK (заголовочные файлы)

- `/RFID` — папка проекта Visual Studio

    - `dllmain.cpp`
    - `RFID.vcxproj`
    - `RFID.sln`

- `/module` — основная папка модуля

    - `RFID.dll`
    - `reader.py` — обёртка над C++-модулем, работа с ридером
    - `logic.py`
    - `FedmIscCoreVC110.dll`, `feisc.dll`, `fefu.dll`, `fecom.dll`, `fetcl.dll` — файлы  из FEIG SDK, необходимые для работы `RFID.dll`

![Структура проекта](info/RFID-модуль.png)


#### Подготовка рабочего окружения, сборка проекта

1. Клонировать проект с GitHub'а
2. Скопировать в папку `/lib` заголовочные файлы FEIG SDK с сохранением первоначальной иерархии папок и файлов
3. Скопировать в папку `/module` библиотеки `FedmIscCoreVC110.dll`, `feisc.dll`, `fefu.dll`, `fecom.dll`, `fetcl.dll` из FEIG SDK
4. Установить зависимости для Python-модуля

    Зависимости могут быть установлены с помощью `pip` следующим образом:

    ```
    pip install -r requirements.txt
    ```

5. Собрать C++-модуль

    1. В Visual Studio открыть проект, выбрав файл `/RFID/RFID.vcxproj`
    2. Собрать **32-битную Release-версию**
    3. Итоговый файл `RFID.dll` окажется в папке `/module`

6. Работа с ридером теперь возможна через Python-скрипты


#### Описание API

##### Реализация элементарных функций для управления ридером — `reader.py`

**Reader** — класс для управления ридером

> TODO

##### Высокоуровневое управление ридерами — `logic.py`

> TODO

##### API веб-сервера — `server.py`


Запрос | GET | POST | PUT | DELETE
-------|-----|------|-----|-------
`/` | Страница с описанием API | — | — | —
`/readers/` | Возвращает список настроек для ридеров | Добавляет настройки для ридера | Заменяет все настройки ридеров переданными | Удаляет все настройки ридеров
`/readers/<reader_id>/` | Возвращает настройки ридера | — | Обновляет настройки ридера (а также производит подключение и отключение ридера) | Удаляет ридер
`/readers/<reader_id>/tags/inventory/` | Возвращает идентификаторы меток | — | — | —
`/readers/<reader_id>/tags/` | Возвращает информацию с меток | — | Записывает информацию в метки | Очищает информацию с меток
